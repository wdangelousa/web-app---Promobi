generator client {
  provider   = "prisma-client-js"
  engineType = "library"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  fullName  String
  email     String   @unique
  phone     String?
  role      Role     @default(CLIENT)
  createdAt DateTime @default(now())
  orders    Order[]
}

model Order {
  id                   Int             @id @default(autoincrement())
  userId               Int
  status               OrderStatus     @default(PENDING)
  totalAmount          Float
  requiresNotarization Boolean         @default(false)
  requiresHardCopy     Boolean         @default(false)
  urgency              String          @default("normal")
  uspsTracking         String?
  createdAt            DateTime        @default(now())
  sentAt               DateTime?
  paymentProvider      PaymentProvider @default(STRIPE)
  deliveryUrl          String?
  metadata             String?
  paymentMethod        String?
  hasTranslation       Boolean         @default(true)
  hasNotary            Boolean         @default(false)
  documents            Document[]
  user                 User            @relation(fields: [userId], references: [id])
}

model Document {
  id                Int      @id @default(autoincrement())
  orderId           Int
  docType           String
  fileName          String?
  originalFileUrl   String
  translatedFileUrl String?
  translatedText    String?
  exactNameOnDoc    String?
  createdAt         DateTime @default(now())
  translation_status String   @default("pending")
  delivery_pdf_url   String?
  order             Order    @relation(fields: [orderId], references: [id])
}

model Setting {
  id        Int      @id @default(autoincrement())
  key       String   @unique
  value     String
  updatedAt DateTime @updatedAt
}

enum PaymentProvider {
  STRIPE
  PARCELADO_USA
}

enum Role {
  CLIENT
  OPERATIONS
  FINANCIAL
  TECHNICAL
  PARTNER
}

enum OrderStatus {
  PENDING
  TRANSLATING
  NOTARIZING
  COMPLETED
  PAID
  READY_FOR_REVIEW
  MANUAL_TRANSLATION_NEEDED
  CANCELLED
  PENDING_PAYMENT
  AWAITING_VERIFICATION
}
